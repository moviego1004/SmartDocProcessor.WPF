<Window x:Class="SmartDocProcessor.WPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Smart Doc Processor (WPF Pro)" Height="800" Width="1200"
        WindowStartupLocation="CenterScreen"
        PreviewKeyDown="Window_PreviewKeyDown">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="280"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <ToolBarTray Grid.Row="0" Grid.ColumnSpan="2" Background="#F0F0F0">
            <ToolBar>
                <Button Content="📂 열기" Click="BtnOpen_Click"/>
                <Button Content="💾 저장" Click="BtnSave_Click" ToolTip="현재 파일에 덮어쓰기"/>
                <Button Content="💾 다른 이름으로 저장" Click="BtnSaveAs_Click"/>
                <Separator/>
                <ToggleButton x:Name="BtnCursor" Content="👁️ 커서" Click="BtnTool_Click" Tag="CURSOR" IsChecked="True"/>
                <ToggleButton x:Name="BtnHighlightY" Content="🖍️ 형광(노랑)" Background="Yellow" Click="BtnTool_Click" Tag="HIGHLIGHT_Y"/>
                <ToggleButton x:Name="BtnHighlightO" Content="🖍️ 형광(주황)" Background="Orange" Click="BtnTool_Click" Tag="HIGHLIGHT_O"/>
                <ToggleButton x:Name="BtnUnderline" Content="U 밑줄" Foreground="Red" Click="BtnTool_Click" Tag="UNDERLINE"/>
                <Separator/>
                <ToggleButton x:Name="BtnTextMode" Content="T 텍스트 입력" Click="BtnTool_Click" Tag="TEXT" FontWeight="Bold"/>
                <Separator/>
                <Button Content="↩ 실행 취소" Click="BtnUndo_Click"/>
                <Button Content="🔍 OCR 실행 (전체)" Click="BtnOcr_Click" ToolTip="이미지 문서를 검색 가능한 문서로 변환 (드래그 가능해짐)"/>
                <Separator/>
                <Button Content="❌ 페이지 삭제" Foreground="Red" Click="BtnDeletePage_Click"/>
                <Separator/>
                <TextBlock x:Name="TxtZoom" Text="100%" VerticalAlignment="Center" Margin="5,0"/>
                <Separator/>
                <Button Content="↔ 가로 맞춤" Click="BtnFitWidth_Click"/>
                <Button Content="↕ 세로 맞춤" Click="BtnFitHeight_Click"/>
            </ToolBar>
        </ToolBarTray>

        <Border Grid.Row="1" Grid.Column="0" BorderBrush="#DDDDDD" BorderThickness="0,0,1,0" Background="White" Padding="10">
            <StackPanel>
                <TextBlock Text="속성 편집" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>
                <StackPanel x:Name="PnlProperties" Visibility="Collapsed">
                    <TextBlock Text="선택된 주석:" Foreground="Gray"/>
                    <TextBlock x:Name="TxtSelectedType" FontWeight="Bold" Margin="0,0,0,10"/>
                    <TextBlock Text="텍스트 내용"/>
                    <TextBox x:Name="TxtContent" Height="80" TextWrapping="Wrap" AcceptsReturn="True" Margin="0,5,0,10" TextChanged="TxtProperty_Changed"/>
                    <StackPanel x:Name="PnlTextProps">
                        <TextBlock Text="폰트 종류"/>
                        <ComboBox x:Name="CboPropFontFamily" Margin="0,5,0,10" SelectionChanged="CboPropFontFamily_SelectionChanged">
                            <ComboBoxItem Content="맑은 고딕" Tag="Malgun Gothic" IsSelected="True"/>
                            <ComboBoxItem Content="굴림" Tag="Gulim"/>
                            <ComboBoxItem Content="돋움" Tag="Dotum"/>
                            <ComboBoxItem Content="바탕" Tag="Batang"/>
                        </ComboBox>
                        <TextBlock Text="글자 크기"/>
                        <TextBox x:Name="TxtFontSize" Margin="0,5,0,10" TextChanged="TxtProperty_Changed"/>
                        <CheckBox x:Name="ChkPropBold" Content="굵게 (Bold)" Margin="0,5,0,10" Click="ChkPropBold_Click"/>
                        <TextBlock Text="글자 색상"/>
                        <ComboBox x:Name="CboPropColor" Margin="0,5,0,10" SelectionChanged="CboPropColor_SelectionChanged">
                            <ComboBoxItem Content="검정 (Black)" Tag="#FF000000"/>
                            <ComboBoxItem Content="빨강 (Red)" Tag="#FFFF0000"/>
                            <ComboBoxItem Content="파랑 (Blue)" Tag="#FF0000FF"/>
                            <ComboBoxItem Content="초록 (Green)" Tag="#FF008000"/>
                            <ComboBoxItem Content="회색 (Gray)" Tag="#FF808080"/>
                            <ComboBoxItem Content="흰색 (White)" Tag="#FFFFFFFF"/>
                        </ComboBox>
                    </StackPanel>
                    <Button Content="🗑️ 삭제 (Delete)" Background="#FFDDDD" Margin="0,10" Click="BtnDeleteAnnot_Click"/>
                </StackPanel>
                <TextBlock x:Name="TxtNoSelection" Text="선택된 항목 없음" Foreground="#AAAAAA" FontStyle="Italic"/>
                <Separator Margin="0,20"/>
                <TextBlock Text="문서 정보" FontWeight="Bold"/>
                <TextBlock x:Name="TxtPageInfo" Text="총 0 페이지" Margin="0,5"/>
            </StackPanel>
        </Border>

        <ScrollViewer x:Name="MainScrollViewer" Grid.Row="1" Grid.Column="1" 
                      HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" 
                      Background="#505050" Padding="20"
                      PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
            <StackPanel x:Name="DocumentContainer" HorizontalAlignment="Center" VerticalAlignment="Top">
                <StackPanel.LayoutTransform>
                    <ScaleTransform x:Name="DocScaleTransform" ScaleX="1" ScaleY="1"/>
                </StackPanel.LayoutTransform>
            </StackPanel>
        </ScrollViewer>

        <Popup x:Name="PopupTextMenu" StaysOpen="False" Placement="MousePoint">
            <Border Background="White" BorderBrush="Gray" BorderThickness="1" CornerRadius="5" Padding="5">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="5" ShadowDepth="2" Opacity="0.3"/>
                </Border.Effect>
                <StackPanel Orientation="Horizontal">
                    <Button Content="📋 복사" Background="Transparent" BorderThickness="0" Margin="2" Click="BtnCopyText_Click"/>
                    <Rectangle Width="1" Fill="LightGray" Margin="2"/>
                    <Button Content="🟡 형광" Background="Yellow" BorderThickness="0" Margin="2" Click="BtnMenuHighlightY_Click"/>
                    <Button Content="🟠 형광" Background="Orange" BorderThickness="0" Margin="2" Click="BtnMenuHighlightO_Click"/>
                    <Button Content="U 밑줄" Foreground="Red" Background="Transparent" BorderThickness="0" Margin="2" Click="BtnMenuUnderline_Click"/>
                </StackPanel>
            </Border>
        </Popup>
    </Grid>
</Window>